<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generatore Contratti Manutenzione Sole Facile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #acdd56 0%, #85bc26 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: 80vh;
        }

        .form-section {
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
            overflow-y: auto;
            max-height: 80vh;
        }

        .preview-section {
            padding: 30px;
            background: white;
            overflow-y: auto;
            max-height: 80vh;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #85bc26;
            box-shadow: 0 0 10px rgba(76, 175, 80, 0.3);
        }

        .btn {
            background: linear-gradient(135deg, #85bc26 0%, #45a049 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #5a6268 100%);
        }

        .contract-preview {
            border: 1px solid #ddd;
            padding: 20px;
            background: white;
            font-size: 12px;
            line-height: 1.4;
        }

        .company-info {
            font-size: 10px;
            color: #666;
        }

        .section-title {
            background: #85bc26;
            color: white;
            padding: 10px;
            margin: 20px 0 10px 0;
            font-weight: bold;
        }

        .client-data {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #85bc26;
        }

        .price-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }

        .price-table th, .price-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        .price-table th {
            background-color: #85bc26;
            color: white;
        }

        .signatures {
            margin-top: 40px;
            display: flex;
            justify-content: space-between;
        }

        .signature-box {
            border: 1px solid #ddd;
            padding: 20px;
            width: 45%;
            text-align: center;
        }

        .page-footer {
            display: none;
        }

        .maintenance-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 10px;
        }

        .maintenance-table th, .maintenance-table td {
            border: 1px solid #ddd;
            padding: 6px;
            text-align: center;
        }

        .maintenance-table th {
            background-color: #85bc26;
            color: white;
        }

        .checkmark {
            color: #85bc26;
            font-weight: bold;
        }

        .cross {
            color: #f44336;
            font-weight: bold;
        }

        @media print {
            @page {
                margin-bottom: 60px;
            }
            
            body {
                background: white !important;
            }
            
            .container {
                box-shadow: none;
                border-radius: 0;
                background: white !important;
            }
            
            .header {
                display: none;
            }
            
            .content {
                grid-template-columns: 1fr;
            }
            
            .form-section {
                display: none;
            }
            
            .preview-section {
                max-height: none;
                overflow: visible;
                background: white !important;
            }
            
            .page-footer {
                display: block;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                height: 50px;
                background: white !important;
                border-top: 2px solid #85bc26;
                padding: 10px;
                font-size: 10px;
                text-align: center;
                z-index: 1000;
            }
            
            .section-title {
                page-break-before: auto;
                page-break-after: avoid;
                page-break-inside: avoid;
                background: #85bc26 !important;
                color: white !important;
            }

            .client-data, .price-table, .maintenance-table {
                page-break-inside: avoid;
            }

            .signatures {
                page-break-before: auto;
                page-break-inside: avoid;
            }

            h4 {
                page-break-after: avoid;
            }

            ul, ol {
                page-break-inside: avoid;
            }
            
            * {
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }

            .price-table th, .maintenance-table th {
                background-color: #85bc26 !important;
                color: white !important;
            }

            .checkmark {
                color: #85bc26 !important;
            }

            .cross {
                color: #f44336 !important;
            }

            .client-data {
                border-left: 4px solid #85bc26 !important;
            }
        }
    </style>
</head>
<body>
    <div class="page-footer">
        <strong>Sole Facile srl</strong> | Via Nizza 108, 10126 Torino | P.Iva 09557480010 | 
        solefacilesrl@gmail.com | www.solefacilesrl.com | +39 3200103380
    </div>

    <div class="container">
        <div class="header">
            <h1>🔧 Generatore Contratto Manutenzione Sole Facile</h1>
            <p>Sistema di generazione contratti per manutenzione impianti fotovoltaici</p>
        </div>

        <div class="content">
            <div class="form-section">
                <h2>📋 Dati Contratto</h2>
                
                <div class="form-group">
                    <label for="clientName">Nome Cliente:</label>
                    <input type="text" id="clientName" placeholder="Nome completo">
                </div>

                <div class="form-group">
                    <label for="clientSurname">Cognome Cliente:</label>
                    <input type="text" id="clientSurname" placeholder="Cognome">
                </div>

                <div class="form-group">
                    <label for="fiscalCode">Codice Fiscale:</label>
                    <input type="text" id="fiscalCode" placeholder="Codice fiscale">
                </div>

                <div class="form-group">
                    <label for="birthPlace">Luogo di Nascita:</label>
                    <input type="text" id="birthPlace" placeholder="Città (Provincia)">
                </div>

                <div class="form-group">
                    <label for="birthDate">Data di Nascita:</label>
                    <input type="date" id="birthDate">
                </div>

                <div class="form-group">
                    <label for="residence">Residenza:</label>
                    <input type="text" id="residence" placeholder="Via, numero civico">
                </div>

                <div class="form-group">
                    <label for="residenceCity">Comune Residenza:</label>
                    <input type="text" id="residenceCity" placeholder="Città (Provincia)">
                </div>

                <div class="form-group">
                    <label for="installationSite">Sito Impianto:</label>
                    <input type="text" id="installationSite" placeholder="Via, numero civico">
                </div>

                <div class="form-group">
                    <label for="installationCity">Comune Impianto:</label>
                    <input type="text" id="installationCity" placeholder="Città (Provincia)">
                </div>

                <div class="form-group">
                    <label for="phone">Telefono:</label>
                    <input type="tel" id="phone" placeholder="Numero di telefono">
                </div>

                <div class="form-group">
                    <label for="mobile">Cellulare:</label>
                    <input type="tel" id="mobile" placeholder="Numero cellulare">
                </div>

                <div class="form-group">
                    <label for="email">E-mail:</label>
                    <input type="email" id="email" placeholder="indirizzo@email.com">
                </div>

                <div class="form-group">
                    <label for="pec">PEC:</label>
                    <input type="email" id="pec" placeholder="pec@pec.it">
                </div>

                <div class="form-group">
                    <label for="power">Potenza Impianto (kWp):</label>
                    <input type="number" id="power" step="0.01" placeholder="es. 6.00">
                </div>

                <div class="form-group">
                    <label for="contractDate">Data Contratto:</label>
                    <input type="date" id="contractDate">
                </div>

                <div class="form-group">
                    <label for="serviceType">Tipo di Servizio:</label>
                    <select id="serviceType">
                        <option value="">Seleziona servizio</option>
                        <option value="pulizia">Pulizia Impianto Fotovoltaico</option>
                        <option value="service_base">Service Base</option>
                        <option value="service_plus">Service Plus</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="contractDuration">Durata Contratto:</label>
                    <select id="contractDuration">
                        <option value="1">1 Anno</option>
                        <option value="2">2 Anni</option>
                        <option value="3">3 Anni</option>
                        <option value="4">4 Anni</option>
                        <option value="5">5 Anni</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="moduleType">Tipo Moduli:</label>
                    <select id="moduleType">
                        <option value="standard">≥ 350 WP/cad (Standard)</option>
                        <option value="small">< 350 WP/cad (Maggiorazione)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="price1">Prezzo 1 (€):</label>
                    <input type="number" id="price1" step="0.01" placeholder="0.00">
                </div>

                <div class="form-group">
                    <label for="description1">Descrizione 1:</label>
                    <input type="text" id="description1" placeholder="Descrizione servizio">
                </div>

                <div class="form-group">
                    <label for="price2">Prezzo 2 (€):</label>
                    <input type="number" id="price2" step="0.01" placeholder="0.00">
                </div>

                <div class="form-group">
                    <label for="description2">Descrizione 2:</label>
                    <input type="text" id="description2" placeholder="Descrizione aggiuntiva">
                </div>

                <div class="form-group">
                    <label for="price3">Prezzo 3 (€):</label>
                    <input type="number" id="price3" step="0.01" placeholder="0.00">
                </div>

                <div class="form-group">
                    <label for="description3">Descrizione 3:</label>
                    <input type="text" id="description3" placeholder="Descrizione aggiuntiva">
                </div>

                <button class="btn" onclick="generateContract()">🔄 Aggiorna Anteprima</button>
                <button class="btn btn-secondary" onclick="printContract()">🖨️ Stampa Contratto</button>
                <button class="btn btn-secondary" onclick="clearForm()">🗑️ Pulisci Form</button>
            </div>

            <div class="preview-section">
                <div id="contractPreview" class="contract-preview">
                    <h2 style="text-align: center; margin-bottom: 30px;">CONTRATTO DI MANUTENZIONE IMPIANTO FOTOVOLTAICO</h2>

                    <p>Spettabile cliente, a seguito della sua gentile richiesta siamo lieti di formulare di seguito nostra migliore offerta per <strong>PIANO DI MANUTENZIONE IMPIANTO FOTOVOLTAICO</strong>.</p>

                    <div class="section-title">DATI CLIENTE</div>
                    <div class="client-data" id="clientDataPreview">
                        <p><strong>Nome:</strong> <span id="previewName">_________________</span></p>
                        <p><strong>Cognome:</strong> <span id="previewSurname">_________________</span></p>
                        <p><strong>Codice Fiscale:</strong> <span id="previewFiscalCode">_________________</span></p>
                        <p><strong>Residenza:</strong> <span id="previewResidence">_________________</span></p>
                        <p><strong>Comune:</strong> <span id="previewResidenceCity">_________________</span></p>
                        <p><strong>Sito impianto:</strong> <span id="previewInstallationSite">_________________</span></p>
                        <p><strong>Comune:</strong> <span id="previewInstallationCity">_________________</span></p>
                        <p><strong>Telefono:</strong> <span id="previewPhone">_________________</span></p>
                        <p><strong>Cellulare:</strong> <span id="previewMobile">_________________</span></p>
                        <p><strong>E-mail:</strong> <span id="previewEmail">_________________</span></p>
                        <p><strong>PEC:</strong> <span id="previewPec">_________________</span></p>
                    </div>

                    <p>L'anno <span id="previewYear">____</span>, addì <span id="previewDay">___</span> del mese di <span id="previewMonth">____________</span> in Torino (TO)</p>

                    <p><strong>tra</strong></p>

                    <p><span id="previewFullName">_________________________</span> (CF <span id="previewFiscalCode2">_____________________</span>) nato a <span id="previewBirthPlace">_______________</span> il <span id="previewBirthDate">___/___/______</span>, residente in <span id="previewFullAddress">_____________________</span>, di seguito denominato "Cliente"</p>

                    <p><strong>e</strong></p>

                    <p>la Società <strong>Sole Facile S.R.L.</strong>, con sede legale in via Nizza 108, 10126, TORINO (TO), P.IVA 09557480010 e C.F. 09557480010, nella persona del suo rappresentante legale</p>

                    <p>e congiuntamente indicati anche come "LE PARTI" e ciascuna di esse "LA PARTE"</p>

                    <p><strong>si conviene e stipula quanto segue:</strong></p>

                    <div class="section-title">1. Oggetto e descrizione dei servizi offerti</div>

                    <h4>1.1 Oggetto dell'offerta di manutenzione</h4>
                    <p>La ditta Sole Facile SRL si impegna a fornire al cliente un insieme di servizi riguardanti la manutenzione ordinaria e/o straordinaria dell'impianto fotovoltaico della potenza di <span id="previewPower">_____,___</span> kWP, ubicato sulla/e copertura/e degli edifici nella disponibilità del cliente stesso, e precisamente siti alla <span id="previewInstallationSite2">_____________________</span>.</p>

                    <h4>1.2 Descrizione lavori inclusi per tipologia di manutenzione</h4>
                    <p>La manutenzione ordinaria (preventiva), di cui al pacchetto "SERVICE BASE" consiste in:</p>
                    <ul>
                        <li>verifica del corretto funzionamento dell'inverter sul display (se presente) oppure sugli indicatori LED;</li>
                        <li>pulizia dell'inverter;</li>
                        <li>verifica del funzionamento dei dispositivi di sicurezza;</li>
                        <li>verifica della presenza di rotture o fessurizzazione del vetro dei moduli;</li>
                        <li>verifica dei cavi di collegamento dei moduli;</li>
                        <li>verifica dello stato dei moduli fotovoltaici;</li>
                        <li>verifica meccanica a campione del serraggio dei morsetti di fissaggio;</li>
                        <li>verifica elettrica generale;</li>
                        <li>misurazione dei valori di tensione e corrente di ogni stringa di moduli.</li>
                    </ul>
                    <p>A fine ispezione è previsto il rilascio di una check-list di intervento con evidenza delle operazioni effettuate e relativa indicazione delle eventuali anomalie riscontrate.</p>

                    <p>Il servizio di manutenzione ordinaria richiesto prevede un intervento una tantum, e nel caso di sottoscrizione di contratto con durata pluriennale saranno applicate scontistiche ad hoc (in quest'ultimo caso, per intervento da effettuarsi una volta l'anno per le annualità oggetto di sottoscrizione del contratto).</p>

                    <p>L'opzione "PULIZIA IMPIANTO FOTOVOLTAICO" consiste nell'intervento una tantum per il solo lavaggio dei moduli fotovoltaici di cui all'impianto oggetto del contratto.</p>

                    <p>L'opzione "SERVICE PLUS" pluriennale consiste in tutti i lavori inclusi nell'opzione di manutenzione ordinaria, con l'aggiunta dei seguenti servizi:</p>
                    <ul>
                        <li>lavaggio annuale dei moduli fotovoltaici di cui all'impianto oggetto del contratto;</li>
                        <li>monitoraggio remoto mensile dell'inverter fotovoltaico.</li>
                    </ul>

                    <h4>Manutenzione straordinaria (correttiva)</h4>
                    <p>La manutenzione straordinaria consiste in:</p>
                    <ul>
                        <li>interventi per ripristino rotture;</li>
                        <li>interventi di migliorie sull'impianto;</li>
                        <li>richieste specifiche da parte del Committente, non oggetto di manutenzione ordinaria.</li>
                    </ul>

                    <p>Se il materiale risultato guasto in fase di controllo è coperto da garanzia, verrà sostituito senza onere da parte della Committente ma l'intervento sul posto dovrà essere riconosciuto alla società Appaltatrice.</p>

                    <p>Le attività di manutenzione straordinaria saranno riconosciute normalmente a consuntivo con l'applicazione dei prezzi indicati nel listino DEI – Prezzi informativi dell'Edilizia – Impianti Elettrici – oppure Prezzario regionale della regione di competenza, comprensive delle ore di viaggio necessarie al raggiungimento del sito di intervento.</p>

                    <p>In caso di chiamata per intervento non dovuto o fuori garanzia, il cliente si impegna a riconoscere la somma di € 80,00 (ottanta/00) inclusa IVA al personale tecnico intervenuto per la prima ora, più il corrispettivo orario per il tempo dedicato dai tecnici al raggiungimento del sito di intervento e all'esecuzione dell'intervento di manutenzione oltre la prima ora, come riportato a listino nell'Allegato A.</p>

                    <h4>1.3 Descrizione servizi inclusi per tipologia di pacchetto</h4>
                    <table class="maintenance-table">
                        <tr>
                            <th>Descrizione intervento</th>
                            <th>Frequenza</th>
                            <th>PULIZIA IMPIANTO</th>
                            <th>SERVICE BASE</th>
                            <th>SERVICE PLUS</th>
                        </tr>
                        <tr>
                            <td>Pulizia moduli fotovoltaici</td>
                            <td>annuale</td>
                            <td class="checkmark">✓</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica funzionamento inverter display/LED</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Pulizia inverter</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica funzionamento dispositivi di sicurezza</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica rotture o fessurizzazione vetro moduli</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica stato moduli</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica meccanica serraggio morsetti</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Verifica elettrica generale</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Misurazione valori corrente e tensione stringhe moduli</td>
                            <td>annuale</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                            <td class="checkmark">✓</td>
                        </tr>
                        <tr>
                            <td>Monitoraggio remoto inverter</td>
                            <td>mensile</td>
                            <td class="cross">✗</td>
                            <td class="cross">✗</td>
                            <td class="checkmark">✓</td>
                        </tr>
                    </table>

                    <h4>1.4 Prezzo/i</h4>
                    <table class="price-table">
                        <tr>
                            <th>PREZZI</th>
                            <th>Descrizione breve</th>
                            <th>Prezzo IVA inclusa 10%</th>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td id="serviceDescription1">Servizio selezionato</td>
                            <td>€ <span id="previewPrice1">0,00</span></td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td id="serviceDescription2">-</td>
                            <td>€ <span id="previewPrice2">0,00</span></td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td id="serviceDescription3">-</td>
                            <td>€ <span id="previewPrice3">0,00</span></td>
                        </tr>
                        <tr style="background-color: #f0f0f0; font-weight: bold;">
                            <td colspan="2">TOTALE</td>
                            <td>€ <span id="previewTotal">0,00</span></td>
                        </tr>
                    </table>

                    <div class="section-title">1.5 Esclusioni</div>
                    <p>Sono esclusi dallo scopo del contratto:</p>
                    <ul>
                        <li>eventuale risanamento di difetti del solaio di copertura, anche sopraggiunti a seguito dell'installazione dell'impianto fotovoltaico;</li>
                        <li>pulizia delle superfici calpestabili del solaio di copertura che ospita l'impianto fotovoltaico oggetto di intervento;</li>
                        <li>ricertificazione del quadro esistente del committente secondo normative di riferimento;</li>
                        <li>eventuale costo per il noleggio di mezzi di sollevamento;</li>
                        <li>quanto non espressamente indicato nei lavori inclusi nell'oggetto dell'offerta di manutenzione.</li>
                    </ul>

                    <div class="section-title">1.6 Validità del contratto</div>
                    <p>Il contratto di manutenzione ha decorrenza dalla data di stipula per <span id="previewContractDuration">___</span> anno/i.</p>
                    <p>Il contratto NON si intende tacitamente rinnovato alla scadenza. Il pagamento è anticipato per l'intero corrispettivo indicato.</p>

                    <div class="section-title">1.7 Maggiorazioni per moduli piccoli</div>
                    <p>Si applicano le seguenti maggiorazioni sui prezzi di listino nel caso di intervento su impianti costituiti da moduli fotovoltaici della potenza nominale inferiore a 350 WP/cad:</p>
                    <ul>
                        <li>Maggiorazione del 60% sui prezzi delle opzioni "PULIZIA IMPIANTO FOTOVOLTAICO";</li>
                        <li>Maggiorazione del 20% sui prezzi delle opzioni "SERVICE BASE" e "SERVICE PLUS".</li>
                    </ul>

                    <div class="section-title">1.8 Costi interventi straordinari</div>
                    <p>Nel caso di intervento non dovuto o di intervento non in garanzia si applicano:</p>
                    <ul>
                        <li>Diritto di chiamata: € 80,00 I.I. (inclusa prima ora di intervento)</li>
                        <li>Costo operatore dalla seconda ora: € 38,00/ora I.I.</li>
                        <li>Costo per ogni operatore aggiuntivo: € 38,00/ora I.I.</li>
                        <li>Costo chilometrico oltre 10 km da Torino: € 0,50/km I.I.</li>
                    </ul>

                    <div class="section-title">2. Condizioni e modalità di pagamento</div>
                    <p><strong>Pagamenti LISTINO:</strong> Bonifico Bancario</p>
                    <p>Le attività da riconoscere saranno pagate al 100% tramite B.B. a 30 gg D.F.F.M. previa conferma ed accettazione scritta da parte della Committente delle liste di lavoro presentate.</p>

                    <h4>2.1 Pagamenti Extra o a consuntivo</h4>
                    <p>Il pagamento degli importi dovuti ad attività svolte oltre quelle incluse o ancora dovute a maggiorazioni previste nell'Allegato A saranno rendicontati a fine installazione. Il cliente accetta senza riserva sin da adesso il pagamento di eventuali extra presenti nel verbale di consegna sottoscritto a fine lavori.</p>

                    <h4>2.2 Modalità di pagamento</h4>
                    <p><strong>Bonifico Bancario al seguente conto corrente bancario</strong><br>
                    INTEST. Sole Facile SRL IBAN: IT 94 N 02008 16005 000104507700</p>

                    <div class="signatures">
                        <div class="signature-box">
                            <p>Torino, <span id="signatureDate">___/___/______</span></p>
                            <br><br>
                            <p><strong>Sole Facile</strong></p>
                            <br><br>
                            <p>_________________________________</p>
                            <p>(Rappresentante Legale)</p>
                        </div>
                        <div class="signature-box">
                            <p><strong>Per Accettazione il cliente:</strong></p>
                            <br><br><br>
                            <p>_________________________________</p>
                            <p>(firma per esteso e leggibile)</p>
                        </div>
                    </div>

                    <div style="margin-top: 30px; font-size: 10px;">
                        <p><strong>Ai sensi e per gli effetti degli artt. 1341 e 1342 c.c.</strong> il cliente dichiara di approvare specificatamente le norme contenute negli articoli: 1.4 (Prezzo/i), 2.1 (Pagamenti Extra o a consuntivo).</p>
                        <br>
                        <div style="display: flex; justify-content: space-between;">
                            <div>
                                <p>Torino, ___/___/______</p>
                            </div>
                            <div>
                                <p>Per Accettazione il cliente:</p>
                                <br>
                                <p>_________________________________</p>
                                <p>(firma per esteso e leggibile)</p>
                            </div>
                        </div>
                    </div>

                    <div style="margin-top: 20px;">
                        <p><strong>Allegati</strong></p>
                        <ul>
                            <li>Allegato A – Listino Manutenzione</li>
                        </ul>
                    </div>

                    <!-- Footer con informazioni aziendali -->
                    <div class="footer-info">
                        <strong>Sole Facile srl</strong> | Via Nizza 108, 10126 Torino | P.Iva 09557480010 | 
                        solefacilesrl@gmail.com | www.solefacilesrl.com | +39 3200103380
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize with current date
        document.getElementById('contractDate').value = new Date().toISOString().split('T')[0];

        function generateContract() {
            // Get form values
            const clientName = document.getElementById('clientName').value;
            const clientSurname = document.getElementById('clientSurname').value;
            const fiscalCode = document.getElementById('fiscalCode').value;
            const birthPlace = document.getElementById('birthPlace').value;
            const birthDate = document.getElementById('birthDate').value;
            const residence = document.getElementById('residence').value;
            const residenceCity = document.getElementById('residenceCity').value;
            const installationSite = document.getElementById('installationSite').value;
            const installationCity = document.getElementById('installationCity').value;
            const phone = document.getElementById('phone').value;
            const mobile = document.getElementById('mobile').value;
            const email = document.getElementById('email').value;
            const pec = document.getElementById('pec').value;
            const power = document.getElementById('power').value;
            const contractDate = document.getElementById('contractDate').value;
            const serviceType = document.getElementById('serviceType').value;
            const contractDuration = document.getElementById('contractDuration').value;
            const moduleType = document.getElementById('moduleType').value;
            const price1 = parseFloat(document.getElementById('price1').value) || 0;
            const price2 = parseFloat(document.getElementById('price2').value) || 0;
            const price3 = parseFloat(document.getElementById('price3').value) || 0;
            const description1 = document.getElementById('description1').value;
            const description2 = document.getElementById('description2').value;
            const description3 = document.getElementById('description3').value;

            // Update preview fields
            document.getElementById('previewName').textContent = clientName || '_________________';
            document.getElementById('previewSurname').textContent = clientSurname || '_________________';
            document.getElementById('previewFiscalCode').textContent = fiscalCode || '_________________';
            document.getElementById('previewFiscalCode2').textContent = fiscalCode || '_____________________';
            document.getElementById('previewBirthPlace').textContent = birthPlace || '_______________';
            document.getElementById('previewResidence').textContent = residence || '_________________';
            document.getElementById('previewResidenceCity').textContent = residenceCity || '_________________';
            document.getElementById('previewInstallationSite').textContent = installationSite || '_________________';
            document.getElementById('previewInstallationSite2').textContent = installationSite || '_____________________';
            document.getElementById('previewInstallationCity').textContent = installationCity || '_________________';
            document.getElementById('previewPhone').textContent = phone || '_________________';
            document.getElementById('previewMobile').textContent = mobile || '_________________';
            document.getElementById('previewEmail').textContent = email || '_________________';
            document.getElementById('previewPec').textContent = pec || '_________________';
            document.getElementById('previewPower').textContent = power || '_____,___';
            document.getElementById('previewFullName').textContent = `${clientName} ${clientSurname}` || '_________________________';
            document.getElementById('previewFullAddress').textContent = `${residence}, ${residenceCity}` || '_____________________';

            // Update contract duration
            document.getElementById('previewContractDuration').textContent = contractDuration || '___';

            // Format birth date
            if (birthDate) {
                const date = new Date(birthDate);
                const formattedDate = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
                document.getElementById('previewBirthDate').textContent = formattedDate;
            }

            // Format contract date
            if (contractDate) {
                const date = new Date(contractDate);
                const months = ['gennaio', 'febbraio', 'marzo', 'aprile', 'maggio', 'giugno', 
                              'luglio', 'agosto', 'settembre', 'ottobre', 'novembre', 'dicembre'];
                document.getElementById('previewYear').textContent = date.getFullYear();
                document.getElementById('previewDay').textContent = date.getDate();
                document.getElementById('previewMonth').textContent = months[date.getMonth()];
                document.getElementById('signatureDate').textContent = `${date.getDate().toString().padStart(2, '0')}/${(date.getMonth() + 1).toString().padStart(2, '0')}/${date.getFullYear()}`;
            }

            // Service descriptions - use custom descriptions if provided, otherwise use defaults
            const serviceDescriptions = {
                'pulizia': 'Pulizia Impianto Fotovoltaico',
                'service_base': 'Manutenzione Ordinaria SERVICE BASE',
                'service_plus': 'Manutenzione Ordinaria SERVICE PLUS'
            };

            // Update descriptions - prioritize custom input over automatic logic
            document.getElementById('serviceDescription1').textContent = 
                description1 || serviceDescriptions[serviceType] || 'Servizio selezionato';
            
            document.getElementById('serviceDescription2').textContent = 
                description2 || (contractDuration && parseInt(contractDuration) > 1 ? `Durata contratto: ${contractDuration} anni` : 
                (moduleType === 'small' ? 'Maggiorazione moduli < 350WP' : '-'));
            
            document.getElementById('serviceDescription3').textContent = 
                description3 || (contractDuration && parseInt(contractDuration) > 1 ? 
                (moduleType === 'small' ? 'Maggiorazione moduli < 350WP' : 'Servizio standard') : '-');

            // Update prices
            document.getElementById('previewPrice1').textContent = price1.toFixed(2);
            document.getElementById('previewPrice2').textContent = price2.toFixed(2);
            document.getElementById('previewPrice3').textContent = price3.toFixed(2);
            
            // Calculate total
            const total = price1 + price2 + price3;
            document.getElementById('previewTotal').textContent = total.toFixed(2);

            // Apply surcharges for small modules
            if (moduleType === 'small') {
                const surchargeNote = document.createElement('div');
                surchargeNote.style.cssText = 'background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; margin: 10px 0; border-radius: 5px;';
                surchargeNote.innerHTML = '<strong>⚠️ Nota:</strong> Applicata maggiorazione per moduli < 350 WP/cad';
                
                // Insert after price table
                const priceTable = document.querySelector('.price-table');
                if (priceTable && !document.querySelector('.surcharge-note')) {
                    surchargeNote.classList.add('surcharge-note');
                    priceTable.parentNode.insertBefore(surchargeNote, priceTable.nextSibling);
                }
            } else {
                // Remove surcharge note if switching back to standard modules
                const existingNote = document.querySelector('.surcharge-note');
                if (existingNote) {
                    existingNote.remove();
                }
            }
        }

        function printContract() {
            window.print();
        }

        function clearForm() {
            if (confirm('Sei sicuro di voler cancellare tutti i dati inseriti?')) {
                document.querySelector('.form-section').querySelectorAll('input, select, textarea').forEach(input => {
                    if (input.type !== 'date') {
                        input.value = '';
                    }
                });
                // Reset contract date to today
                document.getElementById('contractDate').value = new Date().toISOString().split('T')[0];
                generateContract();
            }
        }

        // Auto-update preview when form changes
        document.addEventListener('input', generateContract);
        document.addEventListener('change', generateContract);

        // Initialize preview
        generateContract();
    </script>